---
import { personal } from '../data/portfolio';

const links = [
  { href: '#about',        label: 'About' },
  { href: '#skills',       label: 'Skills' },
  { href: '#projects',     label: 'Projects' },
  { href: '#github',       label: 'GitHub' },
  { href: '#blog',         label: 'Blog' },
  { href: '#contact',      label: 'Contact' },
];
---

<nav id="navbar" class="fixed top-0 left-0 right-0 z-50 py-5 transition-all duration-300">
  <div class="max-w-5xl mx-auto px-8">
    <div class="flex items-center justify-between">

      <!-- Logo -->
      <a href="/" class="font-display font-extrabold text-lg tracking-tight"
         style="color:var(--text)">
        {personal.nameShort.split('.')[0]}<span style="color:var(--accent)">.</span>{personal.nameShort.split('.')[1]}
      </a>

      <!-- Links -->
      <ul class="hidden md:flex items-center gap-8 list-none">
        {links.map(l => (
          <li>
            <a href={l.href}
               class="nav-link font-mono text-xs tracking-wider transition-colors duration-300"
               style="color:var(--text-muted)">
              {l.label}
            </a>
          </li>
        ))}
      </ul>

      <!-- Right side -->
      <div class="flex items-center gap-4">
        <!-- Theme Toggle -->
        <div class="flex items-center gap-2">
          <span class="text-sm" style="color:var(--text-muted)">☽</span>
          <button
            id="themeToggle"
            aria-label="Toggle theme"
            class="relative w-11 h-6 rounded-full transition-colors duration-300"
            style="background:var(--bg-3); border:1px solid var(--border)"
          >
            <span
              id="toggleKnob"
              class="absolute top-[3px] left-[3px] w-4 h-4 rounded-full transition-transform duration-300"
            ></span>
          </button>
          <span class="text-sm" style="color:var(--text-muted)">☀</span>
        </div>

        <!-- CTA -->
        <a href="#contact"
           class="hidden md:inline-flex font-mono text-xs px-4 py-2 rounded-md transition-colors duration-300"
           style="background:var(--accent-dim); border:1px solid var(--accent); color:var(--accent)">
          Hire Me →
        </a>

        <!-- Mobile Hamburger -->
        <button id="hamburger" class="md:hidden flex flex-col gap-1.5 p-1" aria-label="Open menu">
          <span class="block w-5 h-px transition-all" style="background:var(--text)"></span>
          <span class="block w-5 h-px transition-all" style="background:var(--text)"></span>
          <span class="block w-5 h-px transition-all" style="background:var(--text)"></span>
        </button>
      </div>

    </div>

    <!-- Mobile Menu -->
    <div id="mobileMenu"
         class="md:hidden hidden mt-4 pb-4 flex-col gap-4"
         style="border-top:1px solid var(--border)">
      <div class="pt-4 flex flex-col gap-3">
        {links.map(l => (
          <a href={l.href}
             class="nav-link font-mono text-sm py-1 transition-colors"
             style="color:var(--text-muted)">
            {l.label}
          </a>
        ))}
      </div>
    </div>

  </div>
</nav>

<script>
  // Scroll effect
  const navbar = document.getElementById('navbar');
  window.addEventListener('scroll', () => {
    if (window.scrollY > 50) {
      navbar!.style.background = 'rgba(10,10,10,0.85)';
      navbar!.style.backdropFilter = 'blur(20px)';
      navbar!.style.borderBottom = '1px solid var(--border)';
    } else {
      navbar!.style.background = 'transparent';
      navbar!.style.backdropFilter = 'none';
      navbar!.style.borderBottom = 'none';
    }
  });

  // Theme toggle
  const toggle = document.getElementById('themeToggle');
  const knob   = document.getElementById('toggleKnob');
  const html   = document.documentElement;

  function applyTheme(theme: string) {
    if (theme === 'light') {
      html.classList.add('light');
      knob!.style.transform = 'translateX(20px)';
      knob!.style.background = '#1a7a10';
    } else {
      html.classList.remove('light');
      knob!.style.transform = 'translateX(0)';
      knob!.style.background = '#7fff6e';
    }
  }

  const saved = localStorage.getItem('theme') || 'dark';
  applyTheme(saved);

  toggle?.addEventListener('click', () => {
    const isLight = html.classList.contains('light');
    const next = isLight ? 'dark' : 'light';
    applyTheme(next);
    localStorage.setItem('theme', next);
  });

  // Mobile menu
  const hamburger   = document.getElementById('hamburger');
  const mobileMenu  = document.getElementById('mobileMenu');
  hamburger?.addEventListener('click', () => {
    mobileMenu!.classList.toggle('hidden');
    mobileMenu!.classList.toggle('flex');
  });

  // Close mobile menu on link click
  mobileMenu?.querySelectorAll('a').forEach(a => {
    a.addEventListener('click', () => {
      mobileMenu.classList.add('hidden');
      mobileMenu.classList.remove('flex');
    });
  });
</script>